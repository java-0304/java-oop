# 객체지향 설계
- 설계 핵심은 의존성을 어떻게 관리는 방법에 따라 설계의 모양이 바뀐다.
- 의존성 예제
- 의존성 관리 방법

## Dependency(의존성) 개념 : 클래스간의 의존성, 패키지간의 의존성 두가지
- 설계란? 코드를 어디에 배치할 것인가에 대한 의사결정
- 어떤 클래스에 어떤 코드를 넣을것이고, 어떹 패키지에 어떤 코드를 넣을 것이며, 어떤 프로젝트에 어떤 코드를 넣을 것인가에 따라서 설계 모양이 바뀐다
- 핵심은 변경에 촛점을 마추어 같이 변경되는 코드는 같이 넣어야 하고, 같이 변경되지 않은 것은 따로 넣어야 합니다.
- A 가 B에 의존한다면 다이어그램은 A에서 B로 향하는 점선으로 그립니다.
- 의존성이 있다는 것은 B가 변경될때 A도 함께 변경(의존성 on)될  가능성이 있어 : 변경이란 클래스이름 변경, 메소드 이름 변경, 구현이 바뀔수 있는것
- 의존성은 변경에 관한것
- 설계를 잘하면 B클래스의 내부 구현이 바꿔도 A 클래스에 변경을 주지 않을 수 도 있다.
- 어쨋거나 의존성은 변경가능성이 있다는 것입니다.
### 클래스 의존성 종류
- >  A -> B Association(연관관계) : A 에서 B 로 이동할 수 있어요. 영구적인 관
  > A에서 B객체를 참조할 수 있다. A에서 B로 가는 경로 가지고 있는 연관관
```
class A{
  private B b
}
```
- > 의존(Dependency) 관계 : 협력하는 딱 그 시점에 일시적으로 관계를 맺고 헤어지는 관계로  메소드 안에서 그 타입의 인스턴스를 생성하거나, 그 타입을 리턴하면 의존관
```
class A{
  public B method(B b){
    return new B();
  }
}
```
- > 상속(Inheritance)관계 : B 구현을 A가 상속받는것, 승계 받는것으로 B가 바뀔때 A 클래스도 같이 변경된다. 구현이 바뀌면 영향을 받는다.
```
class A extends B {
}
```
- > 실체화(Realization)관계 : 인터페이스를 구현하는 것으로 상속과의 다른점은  인터페이스의 시그니처가 바꿨을때 만 영향을 받는것
```
class A implements B{
}
```
- > 패키지 의존성 : 패키지에 포함된 클래스 사이의 의존성
  > packageA.A와 packageB.B 사이의 의존성이란 A가 바뀌면 위의 4가지 의존성이 있으면 패키지간에 의존성이 있디.
  > 의존성을 파악하는 방법으로는  클래스 파일을 열어보면 import 문이 있다면 패키지 의존성이 있다라고 간단히 파악할 수 있다.
### 좋은 의존성을 가지기위한 가이드
1. 양방향 의존성을 피하라. : A에서 B로 가는 의존성이있고, B에서 A로가는 의존성이 있다. A가 바뀔때 B가 바뀌고, B가 바뀔때 A가 바뀐다.
  - A, B 클래스를 하나로 만들어도 되는것을 두개로 찢어놓은 것으로 보인다.
  - A의 setA 메소드에서 B를 콜한다. B를 동기화 시켜줘야한다. 이처럼 연관관계가 양방향인 경위 싱크를 맞추는 과정등에서 많은 버그가 발생할 수 잇다.
  - 양방향 연관관계를 피할 수 있으면 아래처럼 단방향으로 한다. 
```
class A{
  private B b;
  public void setA(B b) {
    this.b = b;
    this.b.setA(this);
  }
}
class B{
  private A a;
  public void setA(A a){
    this.a = a;
}
```
- 단방향
```
class A{
  private B b;
  public void setA(B b){
    this.b = g;
}
class B{
}
```
2. 다중성이 적은 방향을 선택하라 : A에서 B type의컬렉션을 인스턴스 변수로 잡거나 컬렉션에 대해 의존성를 가지는것 보다는 반대 방향의 의존성을 가지도록 코드를 작성한다.
  - One -To - Many(일대다) : A 에서 B로갈때 1:*
  - 리스트나, 컬렉을 인스턴스 변수로 가지면 다양한 이슈가 발생할 수 있다. jap 사용하면 성능이슈가 발생하고, 그 객체들 관계를 유지하기위한 노력이 필요하므로 가급.
  - 가급적이면 다중성이 적은 방향 A가 B의 리스트를 가지는것 보다 B가 A의 단방향 참조를 가지는것이 좋습니다.
  - 다중성이 적은 의존성의 방향을 선택하는 것이 훨 좋다.
  - 의존성이 필요없다면 제거하라.
```
class A{
  private Collection<B> bs;
}
class B{
}
```
  - Many -To - One(다대일) : B에서 A방향으로 가는 *:1 로, 반대 방향의 의존성 가지도로 코드를 작성한다.
```
class A{
}
class B{
  private A a;
}
```
```
3.  A외 B 이에 의존성이 없다면 제거하는것이 좋다. : 의존성 없음
class A{
}
class B{
}
4. 패키지 사이의 의존성 사이클( pa -> pb-> pa) 은 피해야 한다. 하나가 바뀌면 같이 바뀌는 것이므로 패키지 3개가 하나의 패키지라 는것.
packageA -> packageB
packageA <- packageA
- 패키지 사이의 단방향 의존성
packageA --> packageB
  
### 주문 플로우 로 의존성 코드 작성
1. 주문 플로우 ( 영화 예매 )
- 가게선택 > 메뉴선택 > 장바구니담기 -> [주문하기] -> 주문완료 페이이지.
  - 가게 & 메뉴 도메인
   ----------1->*----------1->*------------------1->*--------------:
    Shop(가게): Menu(메뉴)  : OptionGroup(옵션그룸): Option(옵션)    :
                             Specification          Specification
    --------- :------------:----------------------:-----------------:
    가게이름   :  이름       : 이름                 : 이름            :
    영업여부   :  설명       : 배타선택여부          : 가격           :
   최소주문금액:             : 기본옵션여부          :                :
    수수로율   :             :                      :                :
   수수료누적액 :            :                      :                :
   ------------:------------:-----------------------:---------------:

2. 런타임 시 가게와 메뉴 구성도

 Menu(메뉴)              OptionGroup(옵션그룸):               Option(옵션)   
  이름='1인세트'          이름='기본'                          이름='300g'
  설명='고기300g'         기본옵션여부=true                    가격= 14,000원
                          배타선택여부 =true

                         OptionGroup(옵션그룸):               Option(옵션)   
                         이름='고기선택'                      이름='삼겹'
  '                       기본옵션여부=false                   가격= 0원
                          배타선택여부 =true
                                                            Optind(옵션)
                                                             이름='목살'
                                                              가격 =0원
                         OptionGroup(옵션그룸):               Option(옵션)   
                          이름='음료추가선택'                 이름='콜라'
                         기본옵션여부=false                  가격= 1500원
                          배타선택여부 =false
                                                            Option(옵션)
                                                            이름 ='사이다'
                                                            가격 = 1500
   가게(shop)
    가게이름   
    영업여부   
   최소주문금액
    수수로율   
   수수료누적액                                                             

3. 주문
Order
주문시간=2024-03-18 14:00
주문상태 =ordered
1
:
*
주문항목 1:*         주문옵션그룹 1:*           주문옵션
이름 ='1인세트'        이름                       이름
개수 =1                                           가격

주문항목 1:*         주문옵션그룹 1:*           주문옵션
이름 ='직화불고기'     이름 ='기본                이름 ='300g'
개수 =2                                          가격=14000dnjs

                     주문옵션그룹 1:*           주문옵션
                    이름 ='기본                이름 ='300g'
                                               가격=14000dnjs






OrderLineItem     OrderOptionGroup             OrderOption

런타임시 겍체들의 관계가 형성된다.

  

















